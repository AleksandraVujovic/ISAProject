<h1 align-center>Available appointments</h1>

<section class="vh-100 gradient-custom" style="color: #121212">
  <div class="container py-5 h-100">
    <div class="row justify-content-center align-items-center h-100">
      <div class="col-12 col-lg-9 col-xl-7">
        <div
          class="card shadow-2-strong card-registration"
          style="border-radius: 15px"
        >
          <div class="card-body p-1 p-md-4">
            <h2 class="text-center">All blood banks</h2>
            <div style="display: flex">
              <table
                style="margin-left: auto; margin-right: 0%"
                cellspacing="10%"
              >
                <tr>
                  <td>
                    <div style="display: flex">
                      <table
                        style="margin-left: auto; margin-right: 0%"
                        cellspacing="0"
                      >
                        <td>
                          <mat-form-field class="w-100">
                            <mat-label>Start date</mat-label>
                            <input
                              [ngModel]="startDate | date : 'yyyy-MM-dd'"
                              matInput
                              step="any"
                              (ngModelChange)="startDate = $event"
                              type="date"
                            />
                          </mat-form-field>
                        </td>
                        <td>
                          <mat-form-field class="w-100">
                            <mat-label>Start time</mat-label>
                            <input
                              [(ngModel)]="startTime"
                              matInput
                              step="any"
                              type="time"
                            />
                          </mat-form-field>
                        </td>
                        <td class="w-50">
                          <button mat-icon-button (click)="loadAppointments()">
                            <mat-icon matSuffix>search</mat-icon>
                          </button>
                        </td>
                      </table>
                    </div>
                  </td>
                </tr>
              </table>
            </div>
            <div class="course">
              <div
                class="spinner-container w-100"
                *ngIf="appointmentSource.loading$ | async"
              >
                <mat-spinner></mat-spinner>
              </div>
              <table
                mat-table
                [dataSource]="appointmentSource"
                class="w-100 mat-elevation-z8"
                matSort
                matSortDirection="asc"
                matSortDisableClear
              >
                <ng-container matColumnDef="appointmentDate">
                  <th mat-header-cell *matHeaderCellDef class="cell-center">
                    Start date
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let appointment"
                    class="clickable cell-center"
                    (click)="chooseAppointment(appointment.id)"
                  >
                    {{ appointment.appointmentDate }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="startTime">
                  <th mat-header-cell *matHeaderCellDef class="cell-center">
                    Start time
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let appointment"
                    class="clickable cell-center"
                    (click)="chooseAppointment(appointment.id)"
                  >
                    {{ appointment.startTime }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="endTime">
                  <th mat-header-cell *matHeaderCellDef class="cell-center">
                    End time
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let appointment"
                    class="clickable cell-center"
                    (click)="chooseAppointment(appointment.id)"
                  >
                    {{ appointment.endTime }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="bloodBank.name">
                  <th mat-header-cell *matHeaderCellDef class="cell-center">
                    Blood Bank
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let appointment"
                    class="clickable cell-center"
                    (click)="chooseAppointment(appointment.id)"
                  >
                    {{ appointment.bloodBank.name }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="bloodBank.address">
                  <th mat-header-cell *matHeaderCellDef class="cell-center">
                    Address
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let appointment"
                    class="clickable cell-center"
                    (click)="chooseAppointment(appointment.id)"
                  >
                    {{ appointment.bloodBank.address }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="location.rating">
                  <th
                    mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef
                    class="cell-center"
                  >
                    Rating
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let appointment"
                    class="clickable cell-center"
                    (click)="chooseAppointment(appointment.id)"
                  >
                    {{ appointment.bloodBank.rating }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="executed">
                  <th
                    mat-header-cell
                    mat-sort-header
                    *matHeaderCellDef
                    class="cell-center"
                  >
                    Status
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let appointment"
                    class="clickable cell-center"
                    (click)="chooseAppointment(appointment.id)"
                  >
                    {{ appointment.executed }}
                  </td>
                </ng-container>

                <tr
                  mat-header-row
                  *matHeaderRowDef="displayedColumns; sticky: true"
                ></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedColumns"
                ></tr>
              </table>
              <mat-paginator
                [pageSizeOptions]="[5, 10, 20]"
                showFirstLastButtons
                [length]="appointmentSource.count$ | async"
                aria-label="Select page of periodic elements"
              >
              </mat-paginator>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
